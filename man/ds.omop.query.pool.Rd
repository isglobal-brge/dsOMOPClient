% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/queries.R
\name{ds.omop.query.pool}
\alias{ds.omop.query.pool}
\title{Pool query template results across servers}
\usage{
ds.omop.query.pool(
  results,
  query_id = NULL,
  sensitive_fields = NULL,
  pool_strategy = "sum",
  policy = "strict",
  symbol = "omop"
)
}
\arguments{
\item{results}{Named list of per-server data frames (from
\code{ds.omop.query.exec()})}

\item{query_id}{Character; query ID (to look up pool strategy)}

\item{sensitive_fields}{Character vector; columns to apply suppression
pooling rules to. If NULL, auto-detected from query metadata.}

\item{pool_strategy}{Character; "sum" (default), "weighted_mean", or "none"}

\item{policy}{Character; "strict" (NA if any site suppressed) or
"pooled_only_ok" (pool what's available)}

\item{symbol}{Character; OMOP session symbol}
}
\value{
Data frame with pooled results, or NULL if pooling failed
}
\description{
Takes per-server results from \code{ds.omop.query.exec()} and safely
pools them according to the query's pool strategy. Supports:
\itemize{
  \item \code{sum}: Sum count columns across servers
  \item \code{weighted_mean}: Pool means weighted by count
}
}
\details{
Pooling policy:
\itemize{
  \item If any server suppressed a cell (NA), the pooled cell becomes NA
  \item This prevents "pooling to unmask" small-site counts
}
}
