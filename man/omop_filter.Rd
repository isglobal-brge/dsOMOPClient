% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/recipe.R
\name{omop_filter}
\alias{omop_filter}
\alias{omop_filter_sex}
\alias{omop_filter_age}
\alias{omop_filter_age_group}
\alias{omop_filter_has_concept}
\alias{omop_filter_date_range}
\alias{omop_filter_value}
\alias{omop_filter_not_has_concept}
\alias{omop_filter_concept_count}
\alias{omop_filter_prior_observation}
\alias{omop_filter_followup}
\alias{omop_filter_visit_count}
\alias{omop_filter_has_measurement}
\alias{omop_filter_missing_measurement}
\title{Create a filter specification}
\usage{
omop_filter(
  type = c("sex", "age_range", "age_group", "cohort", "has_concept", "date_range",
    "value_threshold", "concept_set", "min_count", "top_n", "dedup", "custom",
    "not_has_concept", "concept_count", "prior_observation", "followup", "visit_count",
    "has_measurement", "missing_measurement"),
  level = c("population", "row", "output"),
  params = list(),
  label = NULL
)

omop_filter_sex(value)

omop_filter_age(min = 0, max = 150)

omop_filter_age_group(groups)

omop_filter_has_concept(
  concept_id,
  table,
  concept_name = NULL,
  window = NULL,
  min_count = 1L
)

omop_filter_date_range(start = NULL, end = NULL)

omop_filter_value(
  column = "value_as_number",
  threshold,
  direction = c("above", "below"),
  safe_bins = NULL
)

omop_filter_not_has_concept(concept_id, table, concept_name = NULL)

omop_filter_concept_count(
  concept_id,
  table,
  min_count = 2L,
  concept_name = NULL
)

omop_filter_prior_observation(min_days = 365L)

omop_filter_followup(min_days = 30L)

omop_filter_visit_count(min_count = 1L, visit_concept_id = NULL)

omop_filter_has_measurement(concept_id, min_value = NULL, max_value = NULL)

omop_filter_missing_measurement(concept_id)
}
\arguments{
\item{type}{Character; filter type. One of \code{"sex"}, \code{"age_range"},
\code{"age_group"}, \code{"cohort"}, \code{"has_concept"},
\code{"date_range"}, \code{"value_threshold"}, \code{"concept_set"},
\code{"min_count"}, \code{"top_n"}, \code{"dedup"}, \code{"custom"}.}

\item{level}{Character; \code{"population"}, \code{"row"}, or \code{"output"}.}

\item{params}{Named list; filter-specific parameters (varies by type).}

\item{label}{Character or \code{NULL}; human-readable description
(auto-generated from type and params if \code{NULL}).}

\item{value}{Character; sex value. Accepts "F", "f", "female", "Female",
"FEMALE", "M", "m", "male", "Male", "MALE" â€” normalized internally to
"F" or "M".}

\item{min}{Numeric; minimum age (inclusive)}

\item{max}{Numeric; maximum age (inclusive)}

\item{groups}{Character vector; age group labels (e.g. c("18-24", "25-34"))}

\item{concept_id}{Integer; measurement concept ID to check absence of}

\item{table}{Character; which OMOP table to check}

\item{concept_name}{Character or NULL; human-readable name}

\item{window}{Named list with start/end offsets, or NULL}

\item{min_count}{Integer; minimum number of visits}

\item{start}{Character; start date (YYYY-MM-DD) or NULL}

\item{end}{Character; end date (YYYY-MM-DD) or NULL}

\item{column}{Character; column to compare}

\item{threshold}{Numeric; threshold value}

\item{direction}{Character; "above" or "below"}

\item{safe_bins}{List with $breaks numeric vector from ds.omop.safe.cutpoints()}

\item{min_days}{Integer; minimum days of followup}

\item{visit_concept_id}{Integer or NULL; visit type filter}

\item{min_value}{Numeric or NULL; minimum value}

\item{max_value}{Numeric or NULL; maximum value}
}
\value{
An \code{omop_filter} object (a named list with class
  \code{"omop_filter"}).
}
\description{
Filters restrict the population or events included in the extraction.
There are three levels: \code{"population"} (person-level inclusion criteria),
\code{"row"} (event-level restrictions), and \code{"output"} (post-extraction
transformations). Filters are added to a recipe via
\code{\link{recipe_add_filter}} and can be nested into groups with
\code{\link{omop_filter_group}}.
}
\details{
Convenience constructors are provided for common filter types:
\code{\link{omop_filter_sex}}, \code{\link{omop_filter_age}},
\code{\link{omop_filter_age_group}}, \code{\link{omop_filter_has_concept}},
\code{\link{omop_filter_date_range}}, \code{\link{omop_filter_value}}.
}
\examples{
\dontrun{
f <- omop_filter(type = "sex", level = "population",
                 params = list(value = "F"))
}
}
\seealso{
\code{\link{recipe_add_filter}}, \code{\link{omop_filter_group}}
}
